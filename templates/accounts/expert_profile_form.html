{% extends "base.html" %}

{% block title %}{% if form.instance.pk %}Edit{% else %}Apply for{% endif %} Expert Profile - Home Maintenance Compass{% endblock %}

{% block content %}
<div class="container mt-4">
    <div class="row justify-content-center">
        <div class="col-md-10 col-lg-8">
            <div class="card shadow">
                <div class="card-header bg-primary text-white">
                    <h4 class="mb-0">
                        <i class="bi bi-award"></i> 
                        {% if form.instance.pk %}Edit Your Expert Profile{% else %}Apply for Local Expert Status{% endif %}
                    </h4>
                </div>
                <div class="card-body">
                    {% if not form.instance.pk %}
                        <div class="alert alert-info">
                            <h5><i class="bi bi-info-circle"></i> About Local Expert Status</h5>
                            <p class="mb-0">
                                Local Experts are verified professionals (contractors, technicians, inspectors) who can share
                                authoritative maintenance tips with the community. To apply, please provide your business
                                information below. An administrator will review your application.
                            </p>
                        </div>
                    {% endif %}
                    
                    {% if user.is_verified_expert %}
                        <div class="alert alert-success">
                            <i class="bi bi-check-circle"></i> 
                            Your expert status is <strong>approved</strong>. You can now create community tips!
                        </div>
                    {% elif form.instance.pk %}
                        <div class="alert alert-warning">
                            <i class="bi bi-hourglass-split"></i> 
                            Your application is <strong>pending review</strong>. You'll be notified when approved.
                        </div>
                    {% endif %}
                    
                    <form method="post" class="mt-4">
                        {% csrf_token %}
                        
                        <h5 class="border-bottom pb-2 mb-3">Company Information</h5>
                        <div class="row">
                            <div class="col-md-8 mb-3">
                                <label for="{{ form.company_name.id_for_label }}" class="form-label">
                                    Company Name <span class="text-danger">*</span>
                                </label>
                                {{ form.company_name }}
                                {% if form.company_name.errors %}
                                    <div class="text-danger small">{{ form.company_name.errors }}</div>
                                {% endif %}
                            </div>
                            <div class="col-md-4 mb-3">
                                <label for="{{ form.trade.id_for_label }}" class="form-label">
                                    Trade/Specialty <span class="text-danger">*</span>
                                </label>
                                {{ form.trade }}
                                {% if form.trade.errors %}
                                    <div class="text-danger small">{{ form.trade.errors }}</div>
                                {% endif %}
                            </div>
                        </div>
                        
                        <h5 class="border-bottom pb-2 mb-3 mt-4">Contact Information</h5>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="{{ form.business_phone.id_for_label }}" class="form-label">
                                    Business Phone <span class="text-danger">*</span>
                                </label>
                                {{ form.business_phone }}
                                <div class="form-text">{{ form.business_phone.help_text }}</div>
                                {% if form.business_phone.errors %}
                                    <div class="text-danger small">{{ form.business_phone.errors }}</div>
                                {% endif %}
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="{{ form.business_email.id_for_label }}" class="form-label">
                                    Business Email <span class="text-danger">*</span>
                                </label>
                                {{ form.business_email }}
                                {% if form.business_email.errors %}
                                    <div class="text-danger small">{{ form.business_email.errors }}</div>
                                {% endif %}
                            </div>
                        </div>
                        
                        <h5 class="border-bottom pb-2 mb-3 mt-4">Business Address</h5>
                        <div class="mb-3">
                            <label for="{{ form.street_address.id_for_label }}" class="form-label">
                                Street Address <span class="text-danger">*</span>
                            </label>
                            {{ form.street_address }}
                            {% if form.street_address.errors %}
                                <div class="text-danger small">{{ form.street_address.errors }}</div>
                            {% endif %}
                        </div>
                        <div class="row">
                            <div class="col-md-5 mb-3">
                                <label for="{{ form.city.id_for_label }}" class="form-label">
                                    City <span class="text-danger">*</span>
                                </label>
                                {{ form.city }}
                                {% if form.city.errors %}
                                    <div class="text-danger small">{{ form.city.errors }}</div>
                                {% endif %}
                            </div>
                            <div class="col-md-3 mb-3">
                                <label for="{{ form.state.id_for_label }}" class="form-label">
                                    State <span class="text-danger">*</span>
                                </label>
                                {{ form.state }}
                                {% if form.state.errors %}
                                    <div class="text-danger small">{{ form.state.errors }}</div>
                                {% endif %}
                            </div>
                            <div class="col-md-4 mb-3">
                                <label for="{{ form.zip_code.id_for_label }}" class="form-label">
                                    ZIP Code <span class="text-danger">*</span>
                                </label>
                                {{ form.zip_code }}
                                {% if form.zip_code.errors %}
                                    <div class="text-danger small">{{ form.zip_code.errors }}</div>
                                {% endif %}
                            </div>
                        </div>
                        
                        <h5 class="border-bottom pb-2 mb-3 mt-4">Professional Credentials</h5>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="{{ form.license_number.id_for_label }}" class="form-label">
                                    License Number
                                </label>
                                {{ form.license_number }}
                                <div class="form-text">{{ form.license_number.help_text }}</div>
                                {% if form.license_number.errors %}
                                    <div class="text-danger small">{{ form.license_number.errors }}</div>
                                {% endif %}
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="{{ form.years_in_business.id_for_label }}" class="form-label">
                                    Years in Business <span class="text-danger">*</span>
                                </label>
                                {{ form.years_in_business }}
                                {% if form.years_in_business.errors %}
                                    <div class="text-danger small">{{ form.years_in_business.errors }}</div>
                                {% endif %}
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <label for="{{ form.website.id_for_label }}" class="form-label">
                                Website
                            </label>
                            {{ form.website }}
                            <div class="form-text">{{ form.website.help_text }}</div>
                            {% if form.website.errors %}
                                <div class="text-danger small">{{ form.website.errors }}</div>
                            {% endif %}
                        </div>
                        
                        <div class="d-flex justify-content-between mt-4">
                            <a href="{% url 'accounts:profile' %}" class="btn btn-secondary">
                                <i class="bi bi-arrow-left"></i> Cancel
                            </a>
                            <button type="submit" class="btn btn-primary">
                                <i class="bi bi-check-circle"></i> 
                                {% if form.instance.pk %}Update Profile{% else %}Submit Application{% endif %}
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
